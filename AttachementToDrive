function AttachementToDrive() {

// Set Email Domain, Email Subject, and Target Folder ID
  const targetFolders = [
    ["", "", ""],
    ["", "". ""]
  ];

  const labelToDrive = GmailApp.getUserLabelByName('ToDrive');
  const query = 'label:todrive';

  const threads = GmailApp.search(query);

  for (const thread of threads) {
    const messages = thread.getMessages();
    for (const message of messages) {
      try {
        let attachements =  message.getAttachments();
        let fromAddress = message.getFrom();
        let subject = message.getSubject();
        let folderID = "";
        
        for (const targetFolder of targetFolders) {
          if (fromAddress.includes(targetFolder[0]) && subject.includes(targetFolder[1])) { folderID = targetFolder[2]; break; }
        }

        const folder = DriveApp.getFolderById(folderID);

        for (const attachement of attachements) {
          let date = message.getDate();
          let splitName = attachement.getName().split('.');
          let fileName = `${splitName[0]}_${Utilities.formatDate(date, 'JST', 'yyyyMMdd_HHmmss')}.${splitName[1]}`;
          attachement.setName(fileName);
          folder.createFile(attachement);
        }
      } catch(e) {
        Logger.log(e.message);
      }
    }
    thread.removeLabel(labelToDrive);
  }
}
